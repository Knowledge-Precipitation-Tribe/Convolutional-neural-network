# Spatially Separable Convolution

空间上可分离的卷积在图像的2D空间维度上进行操作，即高度和宽度。从概念上讲，空间上可分离的卷积将卷积分解为两个单独的运算。对于下面显示的示例，Sobel内核（3x3内核）被分为3x1和1x3内核。

![](../../../.gitbook/assets/image%20%28135%29.png)

在卷积中，3x3内核直接与图像卷积。在空间上可分离的卷积中，3x1内核首先与图像进行卷积。然后应用1x3内核。在执行相同操作时，这将需要6个参数而不是9个参数。

此外，在空间上可分离的卷积中需要比卷积更少的矩阵乘法。举一个具体的例子，在具有3 x 3内核（步幅= 1，填充= 0）的5 x 5图像上进行卷积需要在水平3个位置（垂直3个位置）上扫描内核。总共9个位置，在下图中以点表示。在每个位置上，应用9个逐元素乘法。总体来说，这是9 x 9 = 81乘法。

![](../../../.gitbook/assets/image%20%28127%29.png)

另一方面，对于空间上可分离的卷积，我们首先在5 x 5图像上应用3 x 1的filter。我们在水平5个位置和垂直3个位置扫描这样的内核。总共5 x 3 = 15个位置，在下图中以点表示。在每个位置，应用3个逐元素的乘法。那就是15 x 3 = 45乘法。现在，我们获得了一个3 x 5的矩阵。现在，此矩阵与1 x 3内核卷积，该内核在水平3个位置和垂直3个位置扫描矩阵。对于这9个位置中的每一个，将应用3个按元素的乘法。此步骤需要9 x 3 = 27乘法。因此，总的来说，空间上可分离的卷积需要45 + 27 = 72乘法，小于普通卷积。

![](../../../.gitbook/assets/image%20%28129%29.png)

让我们对以上示例进行一些概括。假设我们现在将卷积应用于kernel为m x m的N x N图像，步幅= 1，填充= 0。传统卷积需要（N-2）x（N-2）x m x m乘法。空间上可分离的卷积需要N x（N-2）x m +（N-2）x（N-2）x m =（2N-2）x（N-2）x m乘法。空间可分离卷积和标准卷积之间的计算成本比为

$$
\frac{2}{m}+\frac{2}{m(N-2)}
$$

对于图像尺寸N远大于filter的kernel的尺寸（N &gt;&gt; m）的图层，此比率变为2 / m。这意味着在这种渐近情况下（N &gt;&gt; m），空间可分离卷积的计算成本是3 x 3的filter标准卷积的2/3。对于5 x 5filter为2/5，对于7 x 7filter为2/7，依此类推。

**尽管空间上可分离的卷积节省了成本，但很少用于深度学习。主要原因之一是，并非所有内核都可以分为两个较小的内核。如果我们用空间可分离的卷积代替所有传统的卷积，那么我们将限制自己在训练期间搜索所有可能的核。训练结果可能不是最佳的。**

